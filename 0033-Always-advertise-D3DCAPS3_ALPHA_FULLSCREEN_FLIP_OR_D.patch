From dbf106a4ded73d817c5cc1a6001fa1bd7d250fdc Mon Sep 17 00:00:00 2001
From: Axel Davy <axel.davy@ens.fr>
Date: Wed, 5 Nov 2014 15:46:59 +0100
Subject: [PATCH 33/34] Always advertise
 D3DCAPS3_ALPHA_FULLSCREEN_FLIP_OR_DISCARD

Signed-off-by: Axel Davy <axel.davy@ens.fr>
---
 src/gallium/state_trackers/nine/adapter9.c | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

diff --git a/src/gallium/state_trackers/nine/adapter9.c b/src/gallium/state_trackers/nine/adapter9.c
index 87ea47a..eed3894 100644
--- a/src/gallium/state_trackers/nine/adapter9.c
+++ b/src/gallium/state_trackers/nine/adapter9.c
@@ -497,15 +497,13 @@ NineAdapter9_GetDeviceCaps( struct NineAdapter9 *This,
                    D3DCAPS2_FULLSCREENGAMMA |
                    D3DCAPS2_CANAUTOGENMIPMAP;
 
-    pCaps->Caps3 =
-                /* D3DCAPS3_ALPHA_FULLSCREEN_FLIP_OR_DISCARD | */
+    /* Note: D3DCAPS3_ALPHA_FULLSCREEN_FLIP_OR_DISCARD just means the
+     * backbuffer can be ARGB (instead of only XRGB) when we are fullscreen
+     * and in discard mode. */
+    pCaps->Caps3 = D3DCAPS3_ALPHA_FULLSCREEN_FLIP_OR_DISCARD |
                    D3DCAPS3_COPY_TO_VIDMEM |
                    D3DCAPS3_COPY_TO_SYSTEMMEM |
                    D3DCAPS3_LINEAR_TO_SRGB_PRESENTATION;
-#ifndef DEBUG
-    /* NOTE: CoD4 requires this to start. */
-    pCaps->Caps3 |= D3DCAPS3_ALPHA_FULLSCREEN_FLIP_OR_DISCARD;
-#endif
 
     pCaps->PresentationIntervals = D3DPRESENT_INTERVAL_DEFAULT |
                                    D3DPRESENT_INTERVAL_ONE |
-- 
2.1.3

